# Kubernetes Deployment

See the topics given below.

## Prerequisite
Please do the following one time requirement steps to configure the Kubernetes environment in your server/machine.

1.  Install Kubernetes from the [Kubernetes Site](https://kubernetes.io/docs/setup/).
2.  Clone the **k8s-ei-operator** GitHub repository.
    ```
    git clone https://github.com/wso2/k8s-ei-operator.git
    ```
2.  Change directory to k8s-ei-operator
    ```
    cd $GOPATH/src/github.com/wso2/wso2/k8s-ei-operator
    ```
3.  Setup Service Account
    ```
    kubectl create -f deploy/service_account.yaml
    ```
5.  Setup RBAC
    ```
    kubectl create -f deploy/role.yaml
    kubectl create -f deploy/role_binding.yaml
    ```
6.  Deploy integration CustomResourceDefinition into Kubernetes cluster to understand custom resource type
    ```
    kubectl create -f deploy/crds/integration_v1alpha1_integration_crd.yaml
    ```
7.  Deploy the k8s-ei-operator
    ```
    kubectl create -f deploy/operator.yaml
    ```
    
## Deploy Kubernetes Cluster

-   Run the following command to deploy the **kubernetes_cr.yaml** configuration file which generated by the [Kubernetes Exporter Project](https://ei.docs.wso2.com/en/latest/micro-integrator/develop/create-kubernetes-project/).
    ```
    kubectl apply -f path/to/kubernetes_cr.yaml
    ```
    
## Run the Solution

-   Port forward to expose the cluster port to outside
    ```
    kubectl port-forward service/<deployment-name>-service 8290:8290
    ```
-   Invoke the service/API using curl.    
